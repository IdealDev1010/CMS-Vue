import fs from 'fs-extra'
import prettyMs from 'pretty-ms'

console.log('Generating icons...')

const start = performance.now()
const sourcePath = 'node_modules/@tabler/icons/icons'
const svg = {}
const icons = [
  '24-hours',
  '2fa',
  '360',
  '3d-cube-sphere',
  'a-b-2',
  'a-b',
  'abacus',
  'abc',
  'access-point',
  'accessible',
  'address-book',
  'adjustments-horizontal',
  'adjustments',
  'aerial-lift',
  'alarm',
  'album',
  'alert-triangle',
  'align-center',
  'align-justified',
  'align-left',
  'align-right',
  'analyze',
  'anchor',
  'angle',
  'api',
  'app-window',
  'apple',
  'apps',
  'archive',
  'arrow-back-up',
  'arrow-back',
  'arrow-bounce',
  'arrow-down',
  'arrow-forward-up',
  'arrow-left',
  'arrow-right',
  'arrow-up',
  'arrows-maximize',
  'arrows-sort',
  'article',
  'aspect-ratio',
  'atom',
  'award',
  'axe',
  'backpack',
  'badge-3d',
  'badge-4k',
  'badge-ad',
  'badge-hd',
  'ballpen',
  'ban',
  'basket',
  'bell',
  'bluetooth',
  'bold',
  'bolt',
  'book',
  'bookmark',
  'box-multiple',
  'box',
  'briefcase',
  'browser',
  'brush',
  'bucket',
  'bug',
  'building-factory',
  'building-store',
  'building',
  'bulb',
  'bus',
  'cake',
  'calculator',
  'calendar-event',
  'calendar',
  'camera',
  'capture',
  'car',
  'cards',
  'cash',
  'cast',
  'cat',
  'category',
  'certificate',
  'chart-bar',
  'chart-dots',
  'chart-pie',
  'check',
  'checkbox',
  'checklist',
  'chef-hat',
  'chevron-down',
  'chevron-left',
  'chevron-right',
  'chevron-up',
  'circle-plus',
  'circles',
  'clear-all',
  'clear-formatting',
  'click',
  'clipboard-copy',
  'clipboard',
  'clock',
  'cloud-computing',
  'cloud',
  'code-circle',
  'code-dots',
  'code-plus',
  'code',
  'coffee',
  'coin',
  'coins',
  'command',
  'compass',
  'components',
  'contrast',
  'cookie',
  'copy',
  'copyright',
  'cpu',
  'credit-card',
  'crop',
  'cup',
  'currency-cent',
  'currency-dollar',
  'currency-euro',
  'current-location',
  'cut',
  'cylinder',
  'database-export',
  'database-import',
  'database',
  'delta',
  'device-desktop',
  'device-floppy',
  'device-gamepad',
  'device-ipad',
  'device-mobile',
  'device-nintendo',
  'device-sd-card',
  'device-tablet',
  'device-tv',
  'device-watch',
  'devices-2',
  'devices',
  'dialpad',
  'diamond',
  'dice',
  'disabled',
  'disc',
  'discount-check',
  'discount',
  'dog',
  'door',
  'dots-vertical',
  'download',
  'droplet',
  'e-passport',
  'edit',
  'egg',
  'eraser',
  'exclamation-circle',
  'external-link',
  'eye-off',
  'eye',
  'eyeglass',
  'file-certificate',
  'file-plus',
  'file-search',
  'file-spreadsheet',
  'file-text',
  'file-zip',
  'file',
  'files',
  'filter-off',
  'filter',
  'fingerprint',
  'fish',
  'flag',
  'flare',
  'flask',
  'focus-centered',
  'focus',
  'folder-plus',
  'folder',
  'forms',
  'frame',
  'gas-station',
  'glass',
  'globe',
  'gps',
  'graph',
  'grid-dots',
  'grip-vertical',
  'h-1',
  'h-2',
  'h-3',
  'h-4',
  'h-5',
  'h-6',
  'heading',
  'headphones',
  'headset',
  'heart',
  'help',
  'highlight',
  'history',
  'home',
  'id',
  'inbox',
  'input-search',
  'italic',
  'key',
  'keyboard',
  'keyframes',
  'language-off',
  'language',
  'layers-difference',
  'layers-intersect',
  'layers-linked',
  'layers-subtract',
  'layers-union',
  'layout-align-bottom',
  'layout-align-center',
  'layout-align-left',
  'layout-align-middle',
  'layout-align-right',
  'layout-align-top',
  'layout-bottombar',
  'layout-cards',
  'layout-columns-3',
  'layout-columns',
  'layout-distribute-horizontal',
  'layout-distribute-vertical',
  'layout-grid-add',
  'layout-list',
  'layout-rows',
  'layout-sidebar-right',
  'layout-sidebar',
  'layout',
  'leaf',
  'link',
  'list-numbers',
  'list',
  'loader-2',
  'location',
  'login',
  'logout',
  'mail-opened',
  'mail',
  'map-pin',
  'map',
  'maximize',
  'message-circle',
  'message',
  'messages',
  'microphone',
  'minimize',
  'moon',
  'mountain',
  'mouse',
  'movie',
  'mug',
  'network',
  'news',
  'note',
  'note',
  'notebook',
  'notes',
  'notification',
  'outlet',
  'package',
  'paint',
  'palette',
  'paperclip',
  'parking',
  'paw',
  'pencil',
  'pennant',
  'perspective',
  'phone',
  'photo',
  'picture-in-picture',
  'pin',
  'placeholder',
  'plane',
  'planet',
  'plant',
  'play-card',
  'player-pause',
  'player-play',
  'playlist',
  'plug',
  'plus',
  'pointer',
  'power',
  'presentation',
  'printer',
  'puzzle',
  'qrcode',
  'quote',
  'radio',
  'rainbow',
  'receipt',
  'recycle',
  'refresh',
  'registered',
  'repeat',
  'report-search',
  'report',
  'resize',
  'ripple',
  'road-sign',
  'road',
  'robot',
  'rocket',
  'rotate',
  'ruler-measure',
  'scale',
  'screenshot',
  'script',
  'search',
  'section',
  'seeding',
  'select-all',
  'send',
  'separator-horizontal',
  'server-2',
  'server',
  'settings-2',
  'settings',
  'shape',
  'share-2',
  'share',
  'shield-lock',
  'shield',
  'shirt',
  'shoe',
  'shopping-bag',
  'shopping-cart',
  'slice',
  'sort-ascending-letters',
  'sort-ascending-numbers',
  'sort-ascending',
  'sort-descending-letters',
  'sort-descending-numbers',
  'sort-descending',
  'soup',
  'spade',
  'spy',
  'square-off',
  'square',
  'stack',
  'stack-2',
  'stack-3',
  'stairs',
  'star-half',
  'star',
  'sticker',
  'strikethrough',
  'subscript',
  'sun',
  'superscript',
  'sword',
  'swords',
  'table',
  'table-export',
  'table-import',
  'tag',
  'tags',
  'target',
  'telescope',
  'terminal',
  'thumb-down',
  'thumb-up',
  'ticket',
  'timeline',
  'tool',
  'tools',
  'track',
  'traffic-lights',
  'transform',
  'trash',
  'tree',
  'trees',
  'typography',
  'umbrella',
  'underline',
  'unlink',
  'upload',
  'urgent',
  'user-circle',
  'user',
  'users',
  'versions',
  'video',
  'viewfinder',
  'vocabulary',
  'volume',
  'walk',
  'waller',
  'wallpaper',
  'wand',
  'wash',
  'wave-sine',
  'webhook',
  'weight',
  'wifi',
  'window',
  'world',
  'writing',
  'x',
]

fs.readdirSync(sourcePath).forEach((file) => {
  const baseName = file.replace('.svg', '')

  if (icons.includes(baseName)) {
    svg[baseName] = fs.readFileSync(`${sourcePath}/${file}`, 'utf-8').replace(/\s*\n\s*/g, '')
  }
})

const iconComponent = [
  `import { Component, Input, OnChanges, SimpleChanges } from '@angular/core'`,
  `import { Icon } from '@pruvious-test/shared'`,
  `import { BaseComponent } from 'src/app/components/base.component'`,
  ``,
  `@Component({`,
  `  selector: 'app-icon',`,
  `  templateUrl: './icon.component.html',`,
  `})`,
  `export class IconComponent extends BaseComponent implements OnChanges {`,
  `  @Input()`,
  `  name!: Icon`,
  ``,
  `  html: string = ''`,
  ``,
  `  ngOnChanges(changes: SimpleChanges): void {`,
  `    if (changes['name']) {`,
  `      switch (this.name) {`,
  ...icons.map((icon) =>
    [`        case '${icon}':`, `          this.html = '${svg[icon]}'`, `          break`].join(
      '\n',
    ),
  ),
  `        default:`,
  `          this.html = ''`,
  `      }`,
  `    }`,
  `  }`,
  `}`,
  ``,
]

fs.writeFileSync(
  'packages/app/src/app/components/ui/icon/icon.component.ts',
  iconComponent.join('\n'),
)

const iconType = [`export type Icon = `, ...icons.map((icon) => `  | '${icon}'`), ``]

fs.writeFileSync('packages/shared/src/icons.ts', iconType.join('\n'))

const time = Math.round(performance.now() - start)

console.log(`Generated ${Object.keys(svg).length} icons in ${prettyMs(time)}.`)
